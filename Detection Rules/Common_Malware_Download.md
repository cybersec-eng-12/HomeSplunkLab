# Possible Malware Downloaded Using PowerShell

## Alert Name: *Suspicious Powershell Download*

## Description
- Detects running of Net.WebClient PowerShell command or it's method DownloadString.

## Data Source & Identifiers
- Sysmon Event ID 1 -> Used to identify a process creation on the system.
- Net.WebClient command
- DownloadString method used 

### SPL Query:
`index=* source="*Sysmon*" EventCode=1 (CommandLine="*Net.WebClient*" OR CommandLine="*DownloadString*")
| table _time, host, ParentUser, CommandLine`

The table command is to display relevant information to the SOC Analyst investigating this alert. Reasons why each were included:
- _time -> the time the command was run
- host -> the machine running the command
- ParentUser -> user who initiated this command
- CommandLine -> entire command that was run

# Alert Being Triggered: 

<img width="2558" height="256" alt="image" src="https://github.com/user-attachments/assets/ccf0f2a4-01f0-470f-810f-74015565a270" />

## Viewed Result:

<img width="2543" height="404" alt="image" src="https://github.com/user-attachments/assets/f0353f12-b9a1-4683-a0de-86368a204bdf" />

# False Positives:
- IT might be downloading a module to use within PowerShell.
- IT might be downloading a file or package for a vendor's software.
